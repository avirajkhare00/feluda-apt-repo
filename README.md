# Feluda APT Repository

This repository contains the APT repository for installing Feluda on Debian-based systems (Ubuntu, Debian, etc.).

## âš ï¸ Important Note

**This repository is not yet ready for installation.** The first package needs to be built before users can install Feluda via APT. Follow the setup instructions below to get started.

## ğŸš€ Initial Setup (Repository Maintainers)

Before users can install Feluda via APT, you need to set up the repository:

### 1. Set up GPG keys
```bash
# Run the setup script to generate GPG keys
./setup.sh
```

### 2. Configure GitHub secrets
- Go to repository Settings â†’ Secrets and variables â†’ Actions
- Add `REPO_ACCESS_TOKEN` with a personal access token (repo scope)
- Add `GPG_PRIVATE_KEY` with the exported private key
- Add `GPG_PASSPHRASE` if you set one

### 3. Build the first package
- Go to the Actions tab in this repository
- Click "Build and Publish DEB Package"
- Enter version "1.9.8"
- Click "Run workflow"

### 4. Test the installation
Once the workflow completes, test the installation on a Debian/Ubuntu system using the instructions below.

## ğŸ“¦ Installation (End Users)

### 1. Add the GPG key

```bash
# Download and add the GPG key
curl -fsSL https://avirajkhare00.github.io/feluda-apt-repo/dists/bionic/Release.gpg | sudo gpg --dearmor -o /usr/share/keyrings/feluda-archive-keyring.gpg
```

**Alternative method** (if the above doesn't work):
```bash
# Import the GPG key directly
curl -fsSL https://avirajkhare00.github.io/feluda-apt-repo/dists/bionic/Release.gpg | sudo apt-key add -
```

**Note**: The GPG key will be available after the first package is built and the repository is initialized.

**Troubleshooting GPG issues**:
If you get "NO_PUBKEY" errors, try these steps:
1. First, try the alternative method above
2. If that doesn't work, the repository might not be signed yet - use the unsigned installation method below

### 2. Add the repository

```bash
# Add the repository to your sources
echo "deb [arch=amd64 signed-by=/usr/share/keyrings/feluda-archive-keyring.gpg] https://avirajkhare00.github.io/feluda-apt-repo/ bionic main" | sudo tee /etc/apt/sources.list.d/feluda.list
```

### 3. Update and install

```bash
sudo apt update

sudo apt install feluda
```

### Alternative: Unsigned Repository (if GPG doesn't work)

If you're having issues with GPG keys, you can use the unsigned repository:

```bash
# Add the repository without GPG verification
echo "deb [trusted=yes] https://avirajkhare00.github.io/feluda-apt-repo/ bionic main" | sudo tee /etc/apt/sources.list.d/feluda.list
```

# Update and install
sudo apt update
sudo apt install feluda
```

**Note**: This method is less secure but will work if GPG signing isn't set up yet.
```

## Usage

After installation, you can use Feluda directly:

```bash
# Basic usage
feluda

# Check specific language
feluda --language rust

# Generate compliance files
feluda generate
```

## Manual Installation

If you prefer to install manually, you can download the `.deb` package directly:

```bash
# Download the latest version
wget https://avirajkhare00.github.io/feluda-apt-repo/pool/main/f/feluda/feluda_1.9.8_amd64.deb
```
```

# Install the package
sudo dpkg -i feluda_1.9.8_amd64.deb

# Fix any missing dependencies
sudo apt-get install -f
```

**Note**: The package will be available after the first build is completed.

## Repository Structure

```
feluda-apt-repo/
â”œâ”€â”€ conf/
â”‚   â””â”€â”€ distributions    # Repository configuration
â”œâ”€â”€ incoming/           # New packages to be added
â”œâ”€â”€ pool/              # Package pool (auto-generated by reprepro)
â”‚   â””â”€â”€ main/
â”‚       â””â”€â”€ f/
â”‚           â””â”€â”€ feluda/  # Package files
â”œâ”€â”€ dists/             # Distribution metadata (auto-generated by reprepro)
â”‚   â””â”€â”€ bionic/
â”‚       â”œâ”€â”€ Release.gpg           # GPG signature file
â”‚       â””â”€â”€ main/
â”‚           â””â”€â”€ binary-amd64/
â”‚               â”œâ”€â”€ Packages      # Package metadata
â”‚               â””â”€â”€ Release       # Release information
â”œâ”€â”€ db/                # Repository database (auto-generated)
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ build-deb.yml  # Automated build workflow
```

## Building Packages

This repository uses GitHub Actions to automatically build and publish new packages when Feluda releases are created.

### Manual Build

To build a package manually:

1. Go to the Actions tab in this repository
2. Click "Build and Publish DEB Package"
3. Enter the version number (e.g., "1.9.8")
4. Click "Run workflow"

### Automated Build

The workflow can be triggered automatically by the main Feluda repository when new releases are published.

## GPG Key Management

The repository is signed with a GPG key for security. The public key (`dists/bionic/Release.gpg`) is generated automatically when the repository is built and should be imported before adding the repository to your system.

### Setting up GPG keys

1. **Generate GPG key** (done automatically by the setup script):
   ```bash
   ./setup.sh
   ```

2. **Add GPG secrets to GitHub**:
   - Go to repository Settings â†’ Secrets and variables â†’ Actions
   - Add `GPG_PRIVATE_KEY` with the exported private key
   - Add `GPG_PASSPHRASE` if you set one

## Support

For issues with the APT repository, please open an issue in this repository.

For issues with Feluda itself, please visit the main repository: https://github.com/anistark/feluda
